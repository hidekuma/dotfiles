# Session End - ì„¸ì…˜ ì¢…ë£Œ

OpenCode ì„¸ì…˜ ì¢…ë£Œ ì‹œ ìƒíƒœë¥¼ ì €ìž¥í•©ë‹ˆë‹¤.

## ëª©ì 

- **ì§„í–‰ ìƒí™© ì €ìž¥**: í˜„ìž¬ ìž‘ì—… ë‚´ìš© ê¸°ë¡
- **ë‹¤ìŒ ì„¸ì…˜ ì¤€ë¹„**: ìž¬ê°œ ì‹œ ë¹ ë¥¸ ì‹œìž‘
- **íŒ¨í„´ ì¶”ì¶œ**: ì„¸ì…˜ ì¤‘ ë°œê²¬í•œ íŒ¨í„´ ì €ìž¥
- **ì»¨í…ìŠ¤íŠ¸ ë³´ì¡´**: í”„ë¡œì íŠ¸ êµ¬ì¡° ë° ê·œì¹™ ì €ìž¥

## ì €ìž¥í•  ì •ë³´

### 1. ì„¸ì…˜ ìƒíƒœ ì €ìž¥

`~/.config/opencode/memory/session-state.json`:

```json
{
  "lastSession": {
    "date": "2026-01-29T16:45:00Z",
    "duration": "2h 15m",
    "project": "/Users/joseph/projects/my-app",
    "currentTask": "ë¦¬í”„ë ˆì‹œ í† í° êµ¬í˜„ ì™„ë£Œ, í…ŒìŠ¤íŠ¸ ìž‘ì„± ì¤‘",
    "completedTasks": [
      "ë¡œê·¸ì¸ ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€",
      "JWT í† í° ìƒì„± ë¡œì§",
      "ë¦¬í”„ë ˆì‹œ í† í° ë©”ì»¤ë‹ˆì¦˜ êµ¬í˜„"
    ],
    "nextSteps": [
      "ì¸ì¦ í…ŒìŠ¤íŠ¸ ìž‘ì„±",
      "API ë¬¸ì„œ ì—…ë°ì´íŠ¸",
      "ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ "
    ],
    "filesModified": [
      "src/auth/refresh-token.ts",
      "src/middleware/auth.ts",
      "prisma/schema.prisma"
    ]
  }
}
```

### 2. í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸

`~/.config/opencode/memory/project-context.json`:

```json
{
  "projectStructure": {
    "type": "monorepo",
    "framework": "Next.js 14",
    "packages": ["web", "api", "shared"],
    "techStack": ["TypeScript", "React", "Prisma", "tRPC"]
  },
  "keyFiles": {
    "auth": [
      "src/auth/index.ts",
      "src/auth/refresh-token.ts",  // ìƒˆë¡œ ì¶”ê°€ë¨
      "src/middleware/auth.ts"
    ]
  },
  "recentChanges": [
    {
      "date": "2026-01-29",
      "area": "authentication",
      "description": "ë¦¬í”„ë ˆì‹œ í† í° ë©”ì»¤ë‹ˆì¦˜ ì¶”ê°€"
    }
  ]
}
```

### 3. í•™ìŠµëœ íŒ¨í„´ ì—…ë°ì´íŠ¸

`~/.config/opencode/memory/learned-patterns.json`:

```json
{
  "patterns": [
    {
      "name": "Refresh Token Pattern",
      "description": "JWT + ë¦¬í”„ë ˆì‹œ í† í° ì¡°í•©",
      "extractedFrom": "session-2026-01-29",
      "example": "accessToken (15m) + refreshToken (7d)",
      "confidence": 0.85,
      "files": ["src/auth/refresh-token.ts"]
    }
  ],
  "lastUpdated": "2026-01-29T16:45:00Z"
}
```

## ì„¸ì…˜ ì¢…ë£Œ ì›Œí¬í”Œë¡œìš°

```
1. ì„¸ì…˜ ì¢…ë£Œ ê°ì§€
   â†“
2. ìž‘ì—… ë‚´ìš© ìš”ì•½
   - ì™„ë£Œí•œ ìž‘ì—…
   - ìˆ˜ì •í•œ íŒŒì¼
   - ë‚¨ì€ ìž‘ì—…
   â†“
3. íŒ¨í„´ ì¶”ì¶œ
   - ë°˜ë³µëœ ì½”ë“œ íŒ¨í„´
   - í”„ë¡œì íŠ¸ ê·œì¹™
   - ì•„í‚¤í…ì²˜ ê²°ì •
   â†“
4. Memory íŒŒì¼ ì—…ë°ì´íŠ¸
   â†“
5. ì‚¬ìš©ìžì—ê²Œ ìš”ì•½ ì œê³µ
   "ì˜¤ëŠ˜ì˜ ìž‘ì—…: {ìš”ì•½}"
   "ë‹¤ìŒ ì„¸ì…˜: {nextSteps}"
```

## ìžë™ ìš”ì•½ ìƒì„±

ì„¸ì…˜ ì¢…ë£Œ ì‹œ ìžë™ìœ¼ë¡œ ìš”ì•½:

```
ðŸ“Š ì„¸ì…˜ ìš”ì•½ (2ì‹œê°„ 15ë¶„)

âœ… ì™„ë£Œ:
  - ë¡œê·¸ì¸ ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
  - JWT í† í° ìƒì„± ë¡œì§
  - ë¦¬í”„ë ˆì‹œ í† í° ë©”ì»¤ë‹ˆì¦˜ êµ¬í˜„

ðŸ“ ìˆ˜ì •í•œ íŒŒì¼ (3ê°œ):
  - src/auth/refresh-token.ts (ìƒˆ íŒŒì¼)
  - src/middleware/auth.ts
  - prisma/schema.prisma

ðŸ“‹ ë‹¤ìŒ ì„¸ì…˜ì— í•  ì¼:
  - ì¸ì¦ í…ŒìŠ¤íŠ¸ ìž‘ì„±
  - API ë¬¸ì„œ ì—…ë°ì´íŠ¸
  - ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ 

ðŸ’¡ í•™ìŠµí•œ íŒ¨í„´:
  - Refresh Token Pattern (JWT + ë¦¬í”„ë ˆì‹œ í† í°)
```

## íŒ¨í„´ ìžë™ ì¶”ì¶œ

ì„¸ì…˜ ì¤‘ ë°œê²¬í•œ íŒ¨í„´ì„ ìžë™ìœ¼ë¡œ ì¶”ì¶œ:

### ì¶”ì¶œ ê¸°ì¤€
1. **ë°˜ë³µ ì‚¬ìš©**: 3íšŒ ì´ìƒ ì‚¬ìš©ëœ íŒ¨í„´
2. **ì¼ê´€ì„±**: ë™ì¼í•œ êµ¬ì¡°/í˜•ì‹
3. **ëª…ì‹œì  ê·œì¹™**: ì£¼ì„ì´ë‚˜ ë¬¸ì„œë¡œ ëª…ì‹œëœ ê·œì¹™

### ì˜ˆì‹œ

```typescript
// ì—¬ëŸ¬ íŒŒì¼ì—ì„œ ë°œê²¬ëœ íŒ¨í„´
try {
  const result = await operation()
  return { success: true, data: result }
} catch (error) {
  return { success: false, error: error.message }
}

// â†’ ìžë™ ì¶”ì¶œ â†’
{
  "name": "Result Type Pattern",
  "description": "ì„±ê³µ/ì‹¤íŒ¨ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” Result íƒ€ìž…",
  "confidence": 0.9
}
```

## êµ¬í˜„

`scripts/session-end.sh`:

```bash
#!/bin/bash

MEMORY_DIR="$HOME/.config/opencode/memory"
SESSION_STATE="$MEMORY_DIR/session-state.json"

echo "ðŸ’¾ ì„¸ì…˜ ì¢…ë£Œ - ìƒíƒœ ì €ìž¥ ì¤‘..."

# Memory ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p "$MEMORY_DIR"

# Git diffë¡œ ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡
MODIFIED_FILES=$(git diff --name-only HEAD 2>/dev/null)

# ì„¸ì…˜ ìƒíƒœ ì €ìž¥
cat > "$SESSION_STATE" <<EOF
{
  "lastSession": {
    "date": "$(date -u +"%Y-%m-%dT%H:%M:%SZ")",
    "project": "$(pwd)",
    "filesModified": [
      $(echo "$MODIFIED_FILES" | sed 's/^/      "/; s/$/"/' | paste -sd "," -)
    ]
  }
}
EOF

echo "âœ… ì„¸ì…˜ ìƒíƒœ ì €ìž¥ ì™„ë£Œ"
echo ""
echo "ðŸ“Š ì„¸ì…˜ ìš”ì•½:"
echo "  ðŸ“ ìˆ˜ì •í•œ íŒŒì¼: $(echo "$MODIFIED_FILES" | wc -l)ê°œ"
echo ""
echo "ë‹¤ìŒ ì„¸ì…˜ì— ëµ™ê² ìŠµë‹ˆë‹¤! ðŸ‘‹"
```

## ìžë™í™”

### 1. ìˆ˜ë™ ì‹¤í–‰
```bash
# ì„¸ì…˜ ì¢…ë£Œ ì‹œ
ì„¸ì…˜ ì¢…ë£Œí•˜ê³  ìƒíƒœ ì €ìž¥í•´ì¤˜
```

### 2. ìžë™ ì‹¤í–‰
- OpenCode ì¢…ë£Œ ì‹œ ìžë™ íŠ¸ë¦¬ê±°
- ë˜ëŠ” ì¼ì • ì‹œê°„ ë¹„í™œì„±í™” í›„ ìžë™ ì‹¤í–‰

### 3. Git Hook ì—°ë™
```bash
# Post-commit hookì— ì¶”ê°€
scripts/session-end.sh
```

## ì´ì 

### ì—°ì†ì„± ðŸ”„
- ìž‘ì—… ë§¥ë½ ìœ ì§€
- ì¤‘ë‹¨/ìž¬ê°œ ìžìœ ë¡œì›€
- ê¸´ í”„ë¡œì íŠ¸ ê´€ë¦¬ ìš©ì´

### í•™ìŠµ ðŸ’¡
- í”„ë¡œì íŠ¸ íŒ¨í„´ ìžë™ í•™ìŠµ
- ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì •í™•ë„ í–¥ìƒ
- íŒ€ ê·œì¹™ ìžë™ íŒŒì•…

### ìƒì‚°ì„± ðŸ“ˆ
- ë‹¤ìŒ ì„¸ì…˜ ë¹ ë¥¸ ì‹œìž‘
- ë¶ˆí•„ìš”í•œ ìž¬íƒìƒ‰ ì œê±°
- ì¼ê´€ëœ ì½”ë“œ í’ˆì§ˆ

## ê°œì¸ì •ë³´ ë³´í˜¸

ì €ìž¥í•˜ì§€ **ì•ŠëŠ”** ê²ƒ:
- API í‚¤, ì‹œí¬ë¦¿
- ì‚¬ìš©ìž ë°ì´í„°
- ë¯¼ê°í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- ê°œì¸ ì‹ë³„ ì •ë³´

ì €ìž¥í•˜ëŠ” ê²ƒ:
- íŒŒì¼ êµ¬ì¡°
- ì½”ë“œ íŒ¨í„´
- ìž‘ì—… ì§„í–‰ ìƒí™©
- ê³µê°œ ê°€ëŠ¥í•œ ì»¨ë²¤ì…˜

## ì²´í¬ë¦¬ìŠ¤íŠ¸

ì„¸ì…˜ ì¢…ë£Œ ì‹œ:
- [ ] í˜„ìž¬ ìž‘ì—… ì €ìž¥ë¨
- [ ] ìˆ˜ì • íŒŒì¼ ëª©ë¡ ì €ìž¥ë¨
- [ ] ë‹¤ìŒ ë‹¨ê³„ ëª…ì‹œë¨
- [ ] íŒ¨í„´ ì¶”ì¶œ ì™„ë£Œë¨
- [ ] ì‚¬ìš©ìžì—ê²Œ ìš”ì•½ ì œê³µë¨
- [ ] ë¯¼ê° ì •ë³´ ì œì™¸ í™•ì¸ë¨

## ë‹¤ìŒ ì„¸ì…˜ ë¯¸ë¦¬ë³´ê¸°

```
ë‹¤ìŒ ì„¸ì…˜ì—ì„œëŠ”:

1ï¸âƒ£ ì´ì „ ìž‘ì—… ì»¨í…ìŠ¤íŠ¸ ì¦‰ì‹œ ë¡œë“œ
2ï¸âƒ£ "ë‹¤ìŒ í•  ì¼" ëª©ë¡ ì œì‹œ
3ï¸âƒ£ í•™ìŠµëœ íŒ¨í„´ ìžë™ ì ìš©
4ï¸âƒ£ ë°”ë¡œ ìž‘ì—… ì‹œìž‘ ê°€ëŠ¥

â†’ **5ë¶„ ì´ìƒ ì ˆì•½** âš¡
```
